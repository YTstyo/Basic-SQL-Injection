<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWT Cookie Confusion Vulnerability</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/jsonwebtoken@8.5.1/index.js"></script>
</head>
<body>
    <div class="container">
        <h1>JWT Cookie Confusion Example</h1>
        <p id="status">Not logged in</p>
        <button id="loginButton">Log In</button>
        <button id="getUserDataButton" style="display:none;">Get User Data</button>
        <div id="userData" style="display:none;"></div>
    </div>

    <script>
        const SECRET_KEY = "supersecretkey";
        let token = '';

        document.getElementById('loginButton').addEventListener('click', () => {
            const payload = {
                user: "user123",
                role: "user"
            };
            token = jsonwebtoken.sign(payload, SECRET_KEY);
            document.cookie = `jwt=${token}; path=/; HttpOnly`;
            document.getElementById('status').textContent = "Logged in as user123";
            document.getElementById('loginButton').style.display = 'none';
            document.getElementById('getUserDataButton').style.display = 'inline';
        });

        document.getElementById('getUserDataButton').addEventListener('click', () => {
            const userDataDiv = document.getElementById('userData');
            const cookies = document.cookie.split('; ').reduce((prev, current) => {
                const [name, value] = current.split('=');
                prev[name] = value;
                return prev;
            }, {});

            const jwt = cookies.jwt;
            if (jwt) {
                const decoded = jsonwebtoken.verify(jwt, SECRET_KEY);
                userDataDiv.textContent = `User Data: ${JSON.stringify(decoded)}`;
                userDataDiv.style.display = 'block';
            } else {
                userDataDiv.textContent = "No user data available.";
                userDataDiv.style.display = 'block';
            }
        });
    </script>
</body>
</html>
